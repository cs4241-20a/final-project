(this["webpackJsonpfinal-project"]=this["webpackJsonpfinal-project"]||[]).push([[0],{150:function(e,t,a){e.exports=a(222)},155:function(e,t,a){},156:function(e,t,a){},222:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(16),l=a.n(r),o=(a(155),a(6)),i=(a(156),a(18)),c=a(8),u=a(25),m=a(31),h=a(32),g=a(13),d=a(34),f=a(33),b=a(223),p=a(224),y=a(225),v=a(226),E=a(227),S=a(81),C=a.n(S),N=a(82),k=a.n(N),O=a(83),w=a(85),j=a(51),A=a(17),x=a(84),U=a.n(x),D=a(53),T=new(a(48).w3cwebsocket)("ws://localhost:8000"),B=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var s;return Object(m.a)(this,a),(s=t.call(this,e)).onButtonClicked=function(e){T.send(JSON.stringify({type:"message",msg:document.getElementById("chatinput").value})),s.setState({typedMsg:""})},s.state={songsJSON:[],user1Songs:[],user2Songs:[],columns:[],songNames:[],user1Artists:[],user2Artists:[],user1Albums:[],user2Albums:[],user1Pops:[],user2Pops:[],artistImages:[],showTable:!1,user1:"",user2:"",staticUser1:"",staticUser2:"",showChat:!1,messages:[],overlay:!1,overlayStyle:"none",typedMsg:""},s.overlayDiv=n.a.createRef(),s.getSongs=s.getSongs.bind(Object(g.a)(s)),s.handleUser1Change=s.handleUser1Change.bind(Object(g.a)(s)),s.handleUser2Change=s.handleUser2Change.bind(Object(g.a)(s)),s.setChatState=s.setChatState.bind(Object(g.a)(s)),s.toggleOverlay=s.toggleOverlay.bind(Object(g.a)(s)),s.handleMessageChange=s.handleMessageChange.bind(Object(g.a)(s)),s.parseSongs=s.parseSongs.bind(Object(g.a)(s)),s}return Object(h.a)(a,[{key:"handleUser1Change",value:function(e){this.setState({user1:e.target.value})}},{key:"handleUser2Change",value:function(e){this.setState({user2:e.target.value})}},{key:"handleMessageChange",value:function(e){this.setState({typedMsg:e.target.value})}},{key:"getSongs",value:function(){var e=this,t={user1:this.state.user1,user2:this.state.user2};Object(D.trackPromise)(fetch("/getSongs",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({staticUser1:e.state.user1,staticUser2:e.state.user2,songsJSON:t.intersection,columns:[{dataField:"title",text:"Songs"},{dataField:"artists",text:"Artist"}],showTable:!0,user1:"",user2:"",user1Artists:t.user1Artists,user2Artists:t.user2Artists,user1Albums:t.user1Albums,user2Albums:t.user2Albums,user1Songs:t.user1Songs,user2Songs:t.user2Songs,artistImages:t.artistImages}),e.parseSongs()})))}},{key:"parseSongs",value:function(){for(var e=[],t=[],a=[],s=0;s<this.state.songsJSON.length;s++)e.push({id:s,title:this.state.songsJSON[s].name,artists:this.state.songsJSON[s].artists[0].name});for(var n=0;n<this.state.user1Songs.length;n++)t.push({popularity:this.state.user1Songs[n].popularity});for(var r=0;r<this.state.user2Songs.length;r++)a.push({popularity:this.state.user2Songs[r].popularity});this.setState({songNames:e,user1Pops:t,user2Pops:a})}},{key:"setChatState",value:function(){this.setState({showChat:!0})}},{key:"toggleOverlay",value:function(){"block"===this.state.overlayStyle&&(this.setState({overlayStyle:"none",showChat:!1}),document.body.style.overflow="unset")}},{key:"componentDidMount",value:function(){var e=this;T.onopen=function(){console.log("connection to websocket server")},T.onmessage=function(t){var a=JSON.parse(t.data);console.log("got reply!",a),"message"===a.type&&e.setState((function(t){return{messages:e.state.messages.concat([new j.Message({id:0,message:a.msg})])}}))}}},{key:"render",value:function(){var e,t=this,a=function(e){return Object(D.usePromiseTracker)().promiseInProgress&&n.a.createElement("img",{src:U.a,alt:"loading",style:{width:"5rem",height:"5rem"}})};return n.a.createElement("div",{id:"wrapperDiv"},n.a.createElement("div",{id:"overlay",onClick:this.toggleOverlay,ref:"overlayDiv",style:{display:this.state.overlayStyle}}),n.a.createElement(b.a,{id:"mainDiv"},n.a.createElement("h1",{className:"mt-5",style:{color:"#ffffff"}},"Unify"),n.a.createElement("p",(e={className:"subtitle"},Object(i.a)(e,"className","mb-10"),Object(i.a)(e,"style",{textAlign:"center",color:"#ffffff"}),e),"Compare Spotify playlists!"),n.a.createElement("div",{className:"mt-5 mb-10"},n.a.createElement(v.a,null,n.a.createElement(E.a,null,n.a.createElement(p.a,{type:"text",placeholder:"Enter your Spotify username",className:"form-control",value:this.state.user1,onChange:this.handleUser1Change,required:!0})),n.a.createElement(E.a,null,n.a.createElement(p.a,{type:"text",placeholder:"Enter another Spotify username",className:"form-control",value:this.state.user2,onChange:this.handleUser2Change,required:!0})),n.a.createElement(E.a,null),n.a.createElement(E.a,null,n.a.createElement(y.a,{className:"btn btn-lg btn-block",style:{backgroundColor:"#1DB954",border:"none",outline:"none"},onClick:this.getSongs},"Analyze data")))),n.a.createElement(a,null),function(){if(t.state.showTable)return n.a.createElement("div",null,n.a.createElement("h2",{className:"mt-5 mb-10 user-title"},t.state.staticUser1," and ",t.state.staticUser2),n.a.createElement("div",{className:"mt-5 mb-10"},n.a.createElement("h4",{className:"subtitle"},"Songs in Common"),n.a.createElement(C.a,{headerStyle:{backgroundColor:"#ffffff"},rowStyle:{backgroundColor:"#ffffff"},border:!0,keyField:"id",data:t.state.songNames,columns:t.state.columns,pagination:k()(),bootstrap4:!0})))}(),function(){for(var e=A.e(t.state.user1Albums,(function(e){return e.length}),(function(e){return e.name})),a=A.e(t.state.user2Albums,(function(e){return e.length}),(function(e){return e.name})),s=A.b(t.state.user1Albums,(function(e){return e.name})),r=[],l=0,o=Array.from(e);l<o.length;l++){var i=Object(u.a)(o[l],2),m=i[0];i[1];r.push(m)}for(var h=[],g=0,d=Array.from(a);g<d.length;g++){var f=Object(u.a)(d[g],2),p=f[0];f[1];h.push(p)}var y,v=A.c(r,h),E=[],S=Object(c.a)(v.values());try{for(S.s();!(y=S.n()).done;){var C=y.value,N=e.get(C)+a.get(C);E.push({title:C,sum:N})}}catch(w){S.e(w)}finally{S.f()}E.sort((function(e,t){return A.a(e.sum,t.sum)})),E=E.slice(0,3);for(var k=0;k<E.length;k++){if(void 0===E[k])return;var O=s.get(E[k].title);if(void 0===O[0].artists)return;E[k].artist=O[0].artists.name,E[k].image=O[0].images[1]}if(t.state.showTable&&E.length>2&&t.state.songsJSON.length>2)return n.a.createElement(b.a,{className:"mt-5 mb-10"},n.a.createElement("h4",{className:"subtitle"},"Top Albums in Common"),n.a.createElement("div",{className:"statsDiv"},E.map((function(e){return n.a.createElement("div",{className:"artistName"},n.a.createElement("div",null,n.a.createElement("img",{style:{width:"240px",height:"240px"},alt:"album art",src:e.image.url})),n.a.createElement("p",{className:"statsTitle"},e.title),n.a.createElement("p",null,e.artist))}))))}(),function(){var e=A.d(t.state.user1Pops,(function(e){return e.popularity})),a=A.d(t.state.user2Pops,(function(e){return e.popularity}));if(void 0==e&&void 0==a||(e=e.toFixed(2),a=a.toFixed(2)),t.state.showTable)return n.a.createElement(b.a,{className:"mt-5 mb-10"},n.a.createElement("h4",{className:"subtitle"},"Average Song Popularity"),n.a.createElement("div",{className:"statsDiv"},n.a.createElement("div",{className:"barDiv"},n.a.createElement("div",{className:"fullBar"},n.a.createElement("div",{className:"percentBar",style:{width:"".concat(e,"%")}})),n.a.createElement("p",{className:"statsTitle",style:{color:"#fff"}},t.state.staticUser1),n.a.createElement("p",{style:{color:"#fff"}},e,"%")),n.a.createElement("div",{className:"barDiv"},n.a.createElement("div",{className:"fullBar"},n.a.createElement("div",{className:"percentBar",style:{width:"".concat(a,"%")}})),n.a.createElement("p",{className:"statsTitle",style:{color:"#fff"}},t.state.staticUser2),n.a.createElement("p",{style:{color:"#fff"}},a,"%"))))}(),n.a.createElement(O.a,{icon:w.a,className:"fas-3x sticky-chat",onClick:this.setChatState})),function(){if(t.state.showChat)return"block"!==t.state.overlayStyle&&(t.setState({overlayStyle:"block"}),document.body.style.overflow="hidden"),n.a.createElement("div",{id:"chatDiv"},n.a.createElement(b.a,null,n.a.createElement("h1",{style:{color:"#191414"},className:"mt-5 mb-10"},"Chat"),n.a.createElement(j.ChatFeed,{messages:t.state.messages,isTyping:t.state.is_typing,hasInputField:!1,showSenderName:!0,bubblesCentered:!1,bubbleStyles:{text:{fontSize:16},chatbubble:{borderRadius:70,padding:10,backgroundColor:"#1DB954"},recipientChatbubble:{backgroundColor:"#191414"}}})),n.a.createElement("div",{id:"writeMsgDiv"},n.a.createElement(p.a,{type:"text",id:"chatinput",placeholder:"Type a message",style:{width:"80%",marginRight:"20px"},onChange:t.handleMessageChange,value:t.state.typedMsg}),n.a.createElement(y.a,{className:"btn btn-primary",onClick:function(){return t.onButtonClicked(t.state.messages)}},"Send")))}())}}]),a}(n.a.Component),P=a(24),J=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var s;return Object(m.a)(this,a),(s=t.call(this,e)).login=s.login.bind(Object(g.a)(s)),s}return Object(h.a)(a,[{key:"login",value:function(){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){window.open(e.link,"_blank")}))}},{key:"render",value:function(){return n.a.createElement("div",{id:"wrapperDiv"},n.a.createElement(b.a,{id:"mainDiv",style:{textAlign:"center"}},n.a.createElement("h1",{className:"mt-5 mb-10",style:{color:"#ffffff"}},"Unify"),n.a.createElement(P.b,{to:"/home"},n.a.createElement(y.a,{className:"btn btn-lg btn-block",style:{backgroundColor:"#1DB954",border:"none",outline:"none"},onClick:this.login},"Login"))))}}]),a}(n.a.Component),M=function(){return n.a.createElement("div",{className:"app-routes"},n.a.createElement(o.c,null,n.a.createElement(o.a,{exact:!0,path:"/",component:J}),n.a.createElement(o.a,{exact:!0,path:"/home",component:B})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(219),a(220);l.a.render(n.a.createElement(P.a,null,n.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},84:function(e,t,a){e.exports=a.p+"static/media/spinner.718571f2.gif"}},[[150,1,2]]]);
//# sourceMappingURL=main.9771a476.chunk.js.map